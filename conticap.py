#!/usr/bin/env python2
# -*- coding: utf-8 -*-
"""
Created on Thu Mar 21 00:25:50 2019

@author: leonardo
"""
import numpy as np
from sys import exit

def conticap(mach):
    # Calculates drag coefficient [-] at altitude [m] and Mach number[-]"
    # Drag function for AeroBee sounding rocket.
    machr = [0.1000,0.2000,0.3000,0.4000,0.5000,0.6000,0.7000,0.8000,0.9000,1.0000,1.1000,1.2000,1.3000,1.4000,1.5000,1.6000,1.7000,1.8000,1.9000,2.0000,2.1000,2.2000,2.3000,2.4000,2.5000,2.6000,2.7000,2.8000,2.9000,3.0000,3.1000,3.2000,3.3000,3.4000,3.5000,3.6000,3.7000,3.8000,3.9000,4.0000,4.1000,4.2000,4.3000,4.4000,4.5000,4.6000,4.7000,4.8000,4.9000,5.0000,5.1000,5.2000,5.3000,5.4000,5.5000,5.6000,5.7000,5.8000,5.9000,6.0000,6.1000,6.2000,6.3000,6.4000,6.5000,6.6000,6.7000,6.8000,6.9000]
    Cdr = [0.3374,0.3370,0.3370,0.3381,0.3401,0.3429,0.3474,0.3553,0.3722,0.4763,0.5385,0.5375,0.5270,0.5089,0.4894,0.4705,0.4507,0.4324,0.4151,0.3987,0.3831,0.3698,0.3567,0.3444,0.3334,0.3235,0.3148,0.3063,0.2985,0.2911,0.2843,0.2780,0.2720,0.2664,0.2618,0.2567,0.2518,0.2471,0.2426,0.2381,0.2337,0.2295,0.2255,0.2216,0.2180,0.2143,0.2108,0.2075,0.2045,0.2016,0.1985,0.1957,0.1929,0.1902,0.1876,0.1851,0.1827,0.1800,0.1778,0.1755,0.1734,0.1714,0.1694,0.1677,0.1659,0.1645,0.1632,0.1619,0.1606]
    Cd = np.interp(mach, machr, Cdr);
    
    #Cd = 0.0213137937*mach**14 - 0.3840564414*mach**13 + 2.7354008001*mach**12 - 8.256071913*mach**11 - 5.3219508393*mach**10 + 136.46235491*mach**9 - 540.4362672988*mach**8 + 1187.4750133936*mach**7 - 1650.866272288*mach**6 + 1486.5846920976*mach**5 - 851.652122757*mach**4 + 295.7852551513*mach**3 - 57.0432676563*mach**2 + 5.1768793232*mach
    
    return Cd